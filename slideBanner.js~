window.Cloud = window.Cloud || {};
    
Cloud.slideBanner = function ($this) {
    var $imgList = $this.find('ul.img-list');
    var $li = $this.find('ul.img-list>li');
    var num = $li.length;
    var $triggers = $this.find('ul.slide-triggers');
    if ($triggers.length == 0) {
	$triggers = $('<ul class=\"slide-triggers\"></ul')
	    .appendTo($this);
    };
    var height = $this.innerHeight();
    var speed = 500;
    
    function createTriggers() {
	$li.each(function(index) {
	    $trigger = $('<li>' + (index+1) + '</li>').data('index', index);
	    $triggers.prepend($trigger);
	    $trigger.hover(function() {
		scrollTo($(this).data('index'));
	    });
	});

	$triggers.find('li').last().addClass('active');
    };
    
    function scrollTo(index) {
	if (index >= 0 && index < num) {
	    $imgList.clearQueue().animate({top: -height*index}, speed);
	    $triggers.find('li.active').removeClass('active');
	    $triggers.find('li:eq(' + (num - index - 1) + ')').addClass('active');
	};
    };

    function scrollToNext() {
	var index = $triggers.find('li.active').data('index');
	index = (index+1) % num;
	scrollTo(index);
    };

    function autoStart(interval) {
	setInterval(scrollToNext, interval);
    };

    createTriggers();

    return {
	scroll: scrollTo,
	autoStart: autoStart
    };
};
